{% extends "./layout--fat.html" %}

{% block content %}
{{ govukBackLink({
	text: "Back",
	href: "javascript:history.back()",
	classes: "govuk-!-margin-top-0"
}) }}

<div class="govuk-grid-row govuk-!-margin-top-8">
	<div class="govuk-grid-column-two-thirds">
		<h1 class="govuk-heading-xl govuk-!-margin-bottom-8">
			{{providerInfo.ProviderName}}
			<span class="govuk-caption-l">
				UKPRN: {{providerInfo.Ukprn}}
			</span>
		</h1>

		<h2 class="govuk-heading-s">
			About this provider
		</h2>

		<p>
			{{providerInfo.MarketingInfo | striptags(true) | escape | nl2br | replace('*','&bull;') }}
		</p>

		<hr class="govuk-section-break govuk-section-break--xl">

		<h2 class="govuk-heading-m govuk-!-margin-bottom-0">
			What employers are saying
		</h2>

		{% set ratings = [{
			name: "Excellent",
			reviews: providerInfo.ProviderFeedback.ExcellentFeedbackCount or 0
		},
		{
			name: "Good",
			reviews: providerInfo.ProviderFeedback.GoodFeedbackCount or 0
		},
		{
			name: "Poor",
			reviews: providerInfo.ProviderFeedback.PoorFeedbackCount or 0
		},
		{
			name: "Very poor",
			reviews: providerInfo.ProviderFeedback.VeryPoorFeedbackCount or 0
		}] %}

		<p class="govuk-!-font-size-16 govuk-!-margin-top-0">
			{% set totalRatings = 0 %}
			{% for rating in ratings %}
			{% set totalRatings = totalRatings + rating.reviews %}
			{% endfor %}
			Based on {{totalRatings}} review{{"s" if totalRatings > 1}} from employers that work with this training provider.
		</p>

		<h3 class="govuk-heading-s govuk-!-margin-bottom-2">
			Showing all ratings from October 2018 to now
		</h3>

		{{ govukSelect({
			id: "sort",
			name: "sort",
			classes: "govuk-input--width-10",
			label:
			{
				text: ""
			},
			items:[
			{
				value: "published",
				text: "All sectors",
				selected: true
			},
			{
				value: "",
				text: "Sector name"
			}
			]
		}) }}

		<ul class="graph-list">
			{% for rating in ratings %}
			<li class="level-{{loop.index}}">
				<span class="label">{{rating.name}}</span>
				<span class="chart">
					<span class="graph">
						<span class="bar" style="width: {{ rating.reviews * (100 / (totalRatings or 1)) }}%"></span>
					</span>
				</span>
				<span class="figure govuk-!-font-size-16">{{ rating.reviews }} <span class="govuk-visually-hidden">out of 7 </span>reviews</span>
			</li>
			{% endfor %}
		</ul>

		<div class="govuk-grid-row govuk-!-margin-top-4">
			<div class="govuk-grid-column-one-half">
				<h4 class="govuk-heading-s">
					Strengths
				</h4>

				<ul class="govuk-list">
					{% if providerInfo.ProviderFeedback.Strengths.length > 0 %}
					{% for strength in providerInfo.ProviderFeedback.Strengths %}
					<li>{{strength.Name}}</li>
					{% endfor %}
					{% else %}
					-
					{% endif %}
				</ul>
			</div>

			<div class="govuk-grid-column-one-half">
				<h4 class="govuk-heading-s">
					Things to improve
				</h4>

				<ul class="govuk-list">
					{% if providerInfo.ProviderFeedback.Weaknesses.length > 0 %}
					{% for weakness in providerInfo.ProviderFeedback.Weaknesses %}
					<li>{{weakness.Name}}</li>
					{% endfor %}
					{% else %}
					-
					{% endif %}
				</ul>
			</div>
		</div>

		<hr class="govuk-section-break govuk-section-break--xl">

		<h3 class="govuk-heading-m">
			114 Apprenticeships offered
		</h3>

		{{ govukTable({
			caption: "Months and rates",
			firstCellIsHeader: true,
			head: [
			{
				text: "Apprenticeship"
			},
			{
				text: "Type"
			},
			{
				text: "Level",
				format: "numeric"
			},
			{
				text: "",
				format: "numeric"
			}
			],
			rows: [
			[
			{
				text: "Accounting"
			},
			{
				text: "Framework"
			},
			{
				text: "2",
				format: "numeric"
			},
			{
				html: '<a href="course?provider-link=true&course-link=false">Details</a>',
				format: "numeric"
			}
			],
			[
			{
				text: "Accounting"
			},
			{
				text: "Framework"
			},
			{
				text: "2",
				format: "numeric"
			},
			{
				html: '<a href="course?provider-link=true&course-link=false">Details</a>',
				format: "numeric"
			}
			],
			[
			{
				text: "Accounting"
			},
			{
				text: "Framework"
			},
			{
				text: "2",
				format: "numeric"
			},
			{
				html: '<a href="course?provider-link=true&course-link=false">Details</a>',
				format: "numeric"
			}
			]
			]
		}) }}

	</div>

	<div class="govuk-grid-column-one-third">
		<div class="app-related-items">
			<h3 class="govuk-heading-m">
				Contact details
			</h3>

			<p>
				<b>Website:</b>
				<br>
				<a href="{{providerInfo.Website}}">{{providerInfo.ProviderName}} website </a>
			</p>

			<p>
				<b>Phone number:</b>
				<br>
				{{providerInfo.Phone}}
			</p>

			<p>
				<b>Email:</b>
				<br>
				<a href="#">{{providerInfo.Email}}</a>
			</p>

			<p>
				<b>Address:</b>
				<br>
				{{providerInfo.ProviderName}}<br>
				{{providerInfo.Addresses[0].Street}}<br>
				{{providerInfo.Addresses[0].Town}}<br>
				{{providerInfo.Addresses[0].PostCode}}
			</p>

			<ul class="govuk-list govuk-!-font-size-16">
				<li>
					<a href="https://www.google.com/maps/search/?api=1&query={{providerInfo.ProviderName}} {{providerInfo.Addresses[0].PostCode}}" target="_blank">View on Google Maps</a>
				</li>
				<li>
					<a href="https://www.openstreetmap.org/search?query={{providerInfo.Addresses[0].Street}},{{providerInfo.Addresses[0].PostCode}}" target="_blank">View on Open Street Map</a>
				</li>
			</ul>
		</div>

		<h4 class="govuk-heading-s govuk-!-font-size-16 govuk-!-margin-bottom-1 govuk-!-margin-top-8">
			Content disclaimer
		</h4>
		<p class="govuk-!-font-size-14">
			Education and Skills Funding Agency cannot guarantee the accuracy of course information on this site and makes no representations about the quality of any courses which appear on the site. Education and Skills Funding Agency is not liable for any losses suffered as a result of any party relying on the course information provided.
		</p>
	</div>

	{% endblock %}
